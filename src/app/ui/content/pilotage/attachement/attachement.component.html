

 <div class="midde_cont">
    <div class="container-fluid">
      <div class="row column_title">
        <div class="col-md-12">
          <div class="page_title">
            <h2>Extracter les attachements</h2>
          </div>
        </div>
      </div>
        
            <div class="full graph_head">

                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="searchbyDateTrait" value="DateTrait" [(ngModel)]="searchby">
                          <label class="form-check-label" for="inlineRadio2" >Date début</label>
                    </div>
                    &nbsp; 
                    <div class="form-check form-check-inline">
                        <input type="date" [(ngModel)]="dateDebut" class="form-control" id="dateLivraison" required  name="dateLivraison"/>
                    </div>
                    &nbsp; 
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="searchbyDateTrait" value="DateTrait" [(ngModel)]="searchby">
                          <label class="form-check-label" for="inlineRadio2" >Date Fin</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input type="date" [(ngModel)]="dateFin" class="form-control" id="dateLivraison" required  name="dateLivraison"/>
                    </div> 
            <div class="form-check form-check-inline">
                <button class="bt" (click)="search()"><i class="fa fa-search orange_color fa-2x"></i> </button>
            </div>
          </div>

       <div class="table-responsive-xl">
          <br><br><br><br><br>
          <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-hover">
           <thead>
            <tr>
              <th style="font-weight: bold;background-color:#343a40;color:white;text-align: center;">Type prestation</th>
              <th style="font-weight: bold;background-color:#343a40;color:white;text-align: center;">Réf Dossier</th>
              <th style="font-weight: bold;background-color:#343a40;color:white;text-align: center;">Type élèment</th>
              <th style="font-weight: bold;background-color:#343a40;color:white;text-align: center;">Quantité</th>
              <th style="font-weight: bold;background-color:#343a40;color:white;text-align: center;">Prix BPU (Forfait)</th>
              <th style="font-weight: bold;background-color:#343a40;color:white;text-align: center;">Prix Total HT</th>
              <th style="font-weight: bold;background-color:#343a40;color:white;text-align: center;">Tarif</th>
            </tr>
          </thead>
              <tbody>
                <tr *ngFor="let attach of attachements; let i = index" [class.active]="i == currentIndex" >
                  <td style="color: black;">{{ attach?.type_prestation?.nomPrestation }}</td>
                  <td style="color: black;" *ngIf="attach?.type_prestation?.nomPrestation== 'Evolution statut IMB'"> {{ attach.codeBanbou+ '-'+attach.codeIMB }} </td>
                  <td style="color: black;"> {{ attach.typeelement }} </td>
                  <td style="color: black;"> {{ attach.quantite }} </td>
                  <td style="color: black;"> {{ attach.prix_BPU }} </td>
                  <td style="color: black;"> {{ attach.prix_total }} €</td>
                <td style="color: black;"> {{ attach.tarif }} </td>
              </tr> 
              </tbody>
        </table>
       </div>
       <br>
       <hr>
       <br>
       <div style="text-align: center;">
          <button class="btn btn--radius-2 btn--blue" style="background-color: rgb(245, 108, 17);" type="submit" (click)="downloadExcel()">Extracter Excel</button>
        </div>
    <br>




   
<!-- footer -->
<div class="container-fluid">
    <div class="row">
      <div class="footer">
        <p>Copyright © 2023 Soft BTool All rights reserved.</p>
      </div>
    </div>
  </div>
</div>
<!-- end dashboard inner -->
</div>